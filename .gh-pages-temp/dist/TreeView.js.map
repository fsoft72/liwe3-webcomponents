{"version":3,"file":"TreeView.js","sources":["../src/TreeView.ts"],"sourcesContent":["/**\n * TreeView Web Component\n * A customizable tree view with infinite depth, checkboxes, and folder icons\n */\n\nexport type TreeNode = {\n  id: string;\n  label: string;\n  children?: TreeNode[];\n  icon?: string;\n  customIcon?: string;\n  selected?: boolean;\n  expanded?: boolean;\n};\n\nexport class TreeViewElement extends HTMLElement {\n  declare shadowRoot: ShadowRoot;\n  private treeData: TreeNode[] = [];\n  private selectedIds: Set<string> = new Set();\n  private expandedIds: Set<string> = new Set();\n  private indentWidth: number = 20;\n  private showBorder = true;\n\n  constructor () {\n    super();\n    this.attachShadow( { mode: 'open' } );\n    this.render();\n    this.bindEvents();\n  }\n\n  static get observedAttributes (): string[] {\n    return [ 'data', 'indent-width', 'selected-ids', 'show-border' ];\n  }\n\n  attributeChangedCallback ( name: string, oldValue: string | null, newValue: string | null ): void {\n    if ( oldValue !== newValue ) {\n      if ( name === 'indent-width' ) {\n        this.indentWidth = parseInt( newValue || '20', 10 );\n      }\n\n      if ( name === 'show-border' ) {\n        this.showBorder = newValue !== 'false';\n      }\n      this.render();\n    }\n  }\n\n  get data (): TreeNode[] {\n    const dataAttr = this.getAttribute( 'data' );\n    if ( dataAttr ) {\n      try {\n        return JSON.parse( dataAttr );\n      } catch ( e ) {\n        console.error( 'Invalid data format:', e );\n        return [];\n      }\n    }\n    return this.treeData;\n  }\n\n  set data ( value: TreeNode[] ) {\n    this.treeData = value;\n    this.initializeExpandedState( value );\n    this.setAttribute( 'data', JSON.stringify( value ) );\n  }\n\n  get selectedNodeIds (): string[] {\n    return Array.from( this.selectedIds );\n  }\n\n  set selectedNodeIds ( ids: string[] ) {\n    this.selectedIds = new Set( ids );\n    this.render();\n  }\n\n  get showBorderEnabled (): boolean {\n    return this.showBorder;\n  }\n\n  set showBorderEnabled ( value: boolean ) {\n    this.showBorder = value;\n    this.setAttribute( 'show-border', value.toString() );\n    this.render();\n  }\n\n  /**\n   * Initialize expanded state from the data\n   */\n  private initializeExpandedState ( nodes: TreeNode[] ): void {\n    const traverse = ( node: TreeNode ) => {\n      if ( node.expanded ) {\n        this.expandedIds.add( node.id );\n      }\n      if ( node.children ) {\n        node.children.forEach( traverse );\n      }\n    };\n\n    nodes.forEach( traverse );\n  }\n\n  /**\n   * Toggle node expansion\n   */\n  toggleExpansion ( nodeId: string ): void {\n    // Update DOM directly instead of full re-render\n    const nodeElement = this.shadowRoot.querySelector( `.tree-node[data-node-id=\"${ nodeId }\"]` ) as HTMLElement;\n    if ( !nodeElement ) return;\n\n    // Find the direct child .node-children element (not nested ones)\n    const childrenContainer = Array.from( nodeElement.children ).find(\n      el => el.classList.contains( 'node-children' )\n    ) as HTMLElement | undefined;\n\n    // Determine current state from DOM, not from expandedIds\n    const hasChildrenInDom = !!childrenContainer;\n\n    if ( hasChildrenInDom ) {\n      // Currently expanded - collapse it\n      childrenContainer.remove();\n      this.expandedIds.delete( nodeId );\n\n      // Toggle expand icon rotation\n      const expandIcon = nodeElement.querySelector( '.expand-icon' ) as HTMLElement;\n      if ( expandIcon ) {\n        expandIcon.classList.remove( 'expanded' );\n      }\n\n      this.dispatchEvent( new CustomEvent( 'toggle', {\n        detail: { nodeId, expanded: false }\n      } ) );\n    } else {\n      // Currently collapsed - expand it\n      const node = this.findNode( nodeId );\n      if ( node && node.children ) {\n        const depth = parseInt( nodeElement.dataset.depth || '0', 10 );\n        const childrenHtml = `\n          <div class=\"node-children\">\n            ${ node.children.map( child => this.renderNode( child, depth + 1 ) ).join( '' ) }\n          </div>\n        `;\n        nodeElement.insertAdjacentHTML( 'beforeend', childrenHtml );\n        this.expandedIds.add( nodeId );\n\n        // Toggle expand icon rotation\n        const expandIcon = nodeElement.querySelector( '.expand-icon' ) as HTMLElement;\n        if ( expandIcon ) {\n          expandIcon.classList.add( 'expanded' );\n        }\n\n        this.dispatchEvent( new CustomEvent( 'toggle', {\n          detail: { nodeId, expanded: true }\n        } ) );\n      }\n    }\n  }\n\n  /**\n   * Toggle node selection\n   */\n  toggleSelection ( nodeId: string ): void {\n    const isSelected = this.selectedIds.has( nodeId );\n\n    if ( isSelected ) {\n      this.selectedIds.delete( nodeId );\n    } else {\n      this.selectedIds.add( nodeId );\n    }\n\n    // Update checkbox state directly instead of full re-render\n    const checkbox = this.shadowRoot.querySelector( `.node-checkbox[data-node-id=\"${ nodeId }\"]` ) as HTMLInputElement;\n    if ( checkbox ) {\n      checkbox.checked = !isSelected;\n    }\n\n    this.dispatchEvent( new CustomEvent( 'selectionchange', {\n      detail: { selectedIds: this.selectedNodeIds }\n    } ) );\n  }\n\n  /**\n   * Select all nodes recursively\n   */\n  selectAll (): void {\n    const traverse = ( node: TreeNode ) => {\n      this.selectedIds.add( node.id );\n      if ( node.children ) {\n        node.children.forEach( traverse );\n      }\n    };\n\n    this.data.forEach( traverse );\n    this.render();\n    this.dispatchEvent( new CustomEvent( 'selectionchange', {\n      detail: { selectedIds: this.selectedNodeIds }\n    } ) );\n  }\n\n  /**\n   * Deselect all nodes\n   */\n  deselectAll (): void {\n    this.selectedIds.clear();\n    this.render();\n    this.dispatchEvent( new CustomEvent( 'selectionchange', {\n      detail: { selectedIds: this.selectedNodeIds }\n    } ) );\n  }\n\n  /**\n   * Expand all nodes\n   */\n  expandAll (): void {\n    const traverse = ( node: TreeNode ) => {\n      if ( node.children && node.children.length > 0 ) {\n        this.expandedIds.add( node.id );\n        node.children.forEach( traverse );\n      }\n    };\n\n    this.data.forEach( traverse );\n    this.render();\n  }\n\n  /**\n   * Collapse all nodes\n   */\n  collapseAll (): void {\n    this.expandedIds.clear();\n    this.render();\n  }\n\n  /**\n   * Get node by ID\n   */\n  private findNode ( nodeId: string, nodes: TreeNode[] = this.data ): TreeNode | null {\n    for ( const node of nodes ) {\n      if ( node.id === nodeId ) {\n        return node;\n      }\n      if ( node.children ) {\n        const found = this.findNode( nodeId, node.children );\n        if ( found ) return found;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get the default folder icon\n   */\n  private getDefaultIcon ( node: TreeNode, isExpanded: boolean ): string {\n    if ( node.children && node.children.length > 0 ) {\n      return isExpanded ? 'ðŸ“‚' : 'ðŸ“';\n    }\n    return 'ðŸ“„';\n  }\n\n  /**\n   * Render a single tree node\n   */\n  private renderNode ( node: TreeNode, depth: number = 0 ): string {\n    const isExpanded = this.expandedIds.has( node.id );\n    const isSelected = this.selectedIds.has( node.id );\n    const hasChildren = node.children && node.children.length > 0;\n    const paddingLeft = depth * this.indentWidth;\n\n    // Determine icon to display\n    let iconHtml = '';\n    if ( node.customIcon ) {\n      iconHtml = `<span class=\"node-icon custom-icon\">${ node.customIcon }</span>`;\n    } else if ( node.icon !== undefined && node.icon !== '' ) {\n      iconHtml = `<span class=\"node-icon\">${ node.icon }</span>`;\n    } else if ( node.icon !== '' ) {\n      iconHtml = `<span class=\"node-icon\">${ this.getDefaultIcon( node, isExpanded ) }</span>`;\n    }\n\n    // Render children if expanded\n    let childrenHtml = '';\n    if ( hasChildren && isExpanded ) {\n      childrenHtml = `<div class=\"node-children\">${ node.children!.map( child => this.renderNode( child, depth + 1 ) ).join( '' ) }</div>`;\n    }\n\n    const nodeHtml = `\n      <div class=\"tree-node\" data-node-id=\"${ node.id }\" data-depth=\"${ depth }\">\n        <div class=\"node-content\" style=\"padding-left: ${ paddingLeft }px\">\n          <div class=\"node-controls\">\n            ${ hasChildren\n        ? `<button class=\"expand-toggle\" data-node-id=\"${ node.id }\" aria-label=\"${ isExpanded ? 'Collapse' : 'Expand' }\">\n                   <svg class=\"expand-icon ${ isExpanded ? 'expanded' : '' }\" viewBox=\"0 0 24 24\" width=\"16\" height=\"16\">\n                     <path d=\"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z\"/>\n                   </svg>\n                 </button>`\n        : '<span class=\"expand-spacer\"></span>'\n      }\n            <label class=\"checkbox-wrapper\">\n              <input\n                type=\"checkbox\"\n                class=\"node-checkbox\"\n                data-node-id=\"${ node.id }\"\n                ${ isSelected ? 'checked' : '' }\n              >\n              <span class=\"checkbox-custom\"></span>\n            </label>\n          </div>\n          ${ iconHtml }\n          <span class=\"node-label\" data-node-id=\"${ node.id }\">${ node.label }</span>\n        </div>\n        ${ childrenHtml }\n      </div>\n    `;\n\n    return nodeHtml;\n  }\n\n  /**\n   * Bind event listeners\n   */\n  private bindEvents (): void {\n    // Use event delegation for all interactive elements\n    this.shadowRoot.addEventListener( 'click', ( e ) => {\n      const target = e.target as HTMLElement;\n\n      // Handle expand/collapse toggle button\n      if ( target.closest( '.expand-toggle' ) ) {\n        const button = target.closest( '.expand-toggle' ) as HTMLElement;\n        const nodeId = button.dataset.nodeId;\n        if ( nodeId ) {\n          this.toggleExpansion( nodeId );\n        }\n        return;\n      }\n    } );\n\n    // Handle checkbox changes\n    this.shadowRoot.addEventListener( 'change', ( e ) => {\n      const target = e.target as HTMLInputElement;\n      if ( target.classList.contains( 'node-checkbox' ) ) {\n        const nodeId = target.dataset.nodeId;\n        if ( nodeId ) {\n          // Toggle current node selection\n          this.toggleSelection( nodeId );\n\n          // If this node is a folder, cascade selection state to all descendants\n          const node = this.findNode( nodeId );\n          if ( node && node.children && node.children.length > 0 ) {\n            const checked = !!target.checked;\n\n            const applyToDescendants = ( n: TreeNode ) => {\n              if ( n.children ) n.children.forEach( applyToDescendants );\n              // Skip the root node itself because it's already handled above\n              if ( n.id !== nodeId ) {\n                if ( checked ) this.selectedIds.add( n.id );\n                else this.selectedIds.delete( n.id );\n              }\n            };\n\n            applyToDescendants( node );\n\n            // Update any rendered descendant checkboxes in the DOM\n            const rootEl = this.shadowRoot.querySelector( `.tree-node[data-node-id=\"${ nodeId }\"]` );\n            if ( rootEl ) {\n              rootEl.querySelectorAll<HTMLInputElement>( '.node-checkbox' ).forEach( ( cb ) => {\n                cb.checked = checked;\n              } );\n            }\n\n            this.dispatchEvent( new CustomEvent( 'selectionchange', {\n              detail: { selectedIds: this.selectedNodeIds }\n            } ) );\n          }\n        }\n      }\n    } );\n\n    // Handle double-click events\n    this.shadowRoot.addEventListener( 'dblclick', ( e ) => {\n      const target = e.target as HTMLElement;\n\n      // Ignore double-clicks that originate from the checkbox area\n      if ( target.closest( '.checkbox-wrapper' ) || target.classList.contains( 'node-checkbox' ) ) {\n        e.stopPropagation();\n        e.preventDefault();\n        return;\n      }\n\n      // Check if clicking on a node label or content\n      if ( target.closest( '.node-label' ) || target.closest( '.node-content' ) ) {\n        const nodeContent = target.closest( '.node-content' ) as HTMLElement;\n        if ( !nodeContent ) return;\n\n        const nodeElement = nodeContent.closest( '.tree-node' ) as HTMLElement;\n        if ( !nodeElement ) return;\n\n        const nodeId = nodeElement.dataset.nodeId;\n        if ( !nodeId ) return;\n\n        const node = this.findNode( nodeId );\n        if ( !node ) return;\n\n        // If it's a folder (has children), toggle expansion\n        if ( node.children && node.children.length > 0 ) {\n          this.toggleExpansion( nodeId );\n        } else {\n          // If it's an item (no children), fire itemselected event\n          this.dispatchEvent( new CustomEvent( 'itemselected', {\n            detail: { node, nodeId }\n          } ) );\n        }\n      }\n    } );\n  }\n\n  /**\n   * Render the component\n   */\n  private render (): void {\n    const containerClass = this.showBorder ? 'tree-container bordered' : 'tree-container borderless';\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          font-family: var(--tree-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\n          font-size: var(--tree-font-size, 14px);\n          color: var(--tree-text-color, #333);\n          background: var(--tree-background, transparent);\n          user-select: none;\n        }\n\n        .tree-container {\n          overflow: auto;\n          padding: var(--tree-padding, 8px);\n          border-radius: var(--tree-border-radius, 10px);\n          background: var(--tree-container-background, transparent);\n          border: none;\n        }\n\n        .tree-container.bordered {\n          border: var(--tree-border, 1px solid rgba(15, 23, 42, 0.12));\n          box-shadow: var(--tree-border-shadow, none);\n        }\n\n        .tree-container.borderless {\n          border: none;\n        }\n\n        .tree-node {\n          position: relative;\n        }\n\n        .node-content {\n          display: flex;\n          align-items: center;\n          gap: 6px;\n          padding: 4px 8px;\n          border-radius: var(--tree-node-border-radius, 6px);\n          transition: background-color 0.15s ease;\n          cursor: pointer;\n        }\n\n        .node-content:hover {\n          background-color: var(--tree-hover-background, rgba(0, 123, 255, 0.08));\n        }\n\n        .node-controls {\n          display: flex;\n          align-items: center;\n          gap: 4px;\n        }\n\n        .expand-toggle {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 20px;\n          height: 20px;\n          padding: 0;\n          border: none;\n          background: transparent;\n          cursor: pointer;\n          border-radius: 4px;\n          transition: background-color 0.15s ease;\n        }\n\n        .expand-toggle:hover {\n          background-color: var(--tree-expand-hover-background, rgba(0, 0, 0, 0.1));\n        }\n\n        .expand-toggle:focus {\n          outline: 2px solid var(--tree-focus-color, #007bff);\n          outline-offset: 2px;\n        }\n\n        .expand-icon {\n          fill: var(--tree-icon-color, #666);\n          transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .expand-icon.expanded {\n          transform: rotate(90deg);\n        }\n\n        .expand-spacer {\n          width: 20px;\n          height: 20px;\n          display: inline-block;\n        }\n\n        .checkbox-wrapper {\n          display: flex;\n          align-items: center;\n          cursor: pointer;\n          margin: 0;\n        }\n\n        .node-checkbox {\n          position: absolute;\n          opacity: 0;\n          width: 0;\n          height: 0;\n        }\n\n        .checkbox-custom {\n          position: relative;\n          width: 18px;\n          height: 18px;\n          border: 2px solid var(--tree-checkbox-border, #ccc);\n          border-radius: var(--tree-checkbox-border-radius, 4px);\n          background: var(--tree-checkbox-background, white);\n          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .checkbox-custom::after {\n          content: '';\n          position: absolute;\n          display: none;\n          left: 5px;\n          top: 2px;\n          width: 4px;\n          height: 8px;\n          border: solid white;\n          border-width: 0 2px 2px 0;\n          transform: rotate(45deg);\n        }\n\n        .node-checkbox:checked + .checkbox-custom {\n          background: var(--tree-checkbox-checked-background, #007bff);\n          border-color: var(--tree-checkbox-checked-border, #007bff);\n        }\n\n        .node-checkbox:checked + .checkbox-custom::after {\n          display: block;\n        }\n\n        .checkbox-wrapper:hover .checkbox-custom {\n          border-color: var(--tree-checkbox-hover-border, #999);\n          box-shadow: 0 0 0 3px var(--tree-checkbox-hover-shadow, rgba(0, 123, 255, 0.1));\n        }\n\n        .node-checkbox:focus + .checkbox-custom {\n          outline: 2px solid var(--tree-focus-color, #007bff);\n          outline-offset: 2px;\n        }\n\n        .node-icon {\n          display: inline-flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 18px;\n          min-width: 20px;\n        }\n\n        .node-icon.custom-icon {\n          font-size: var(--tree-custom-icon-size, 20px);\n        }\n\n        .node-label {\n          flex: 1;\n          padding: 2px 4px;\n          color: var(--tree-label-color, #333);\n          font-weight: var(--tree-label-font-weight, 400);\n          line-height: 1.4;\n          cursor: pointer;\n          transition: color 0.15s ease;\n        }\n\n        .node-label:hover {\n          color: var(--tree-label-hover-color, #007bff);\n        }\n\n        .node-children {\n          position: relative;\n        }\n\n        .node-children::before {\n          content: '';\n          position: absolute;\n          left: calc(var(--tree-indent-width, 20px) / 2 + 8px);\n          top: 0;\n          bottom: 0;\n          width: 1px;\n          background: var(--tree-guide-line-color, rgba(0, 0, 0, 0.1));\n        }\n\n        /* Animations */\n        @keyframes slideDown {\n          from {\n            opacity: 0;\n            transform: translateY(-4px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        .node-children {\n          animation: slideDown 0.2s ease-out;\n        }\n\n        /* Empty state */\n        .tree-empty {\n          padding: 32px;\n          text-align: center;\n          color: var(--tree-empty-color, #999);\n          font-style: italic;\n        }\n\n        /* Scrollbar styling */\n        .tree-container::-webkit-scrollbar {\n          width: 8px;\n          height: 8px;\n        }\n\n        .tree-container::-webkit-scrollbar-track {\n          background: var(--tree-scrollbar-track, #f1f1f1);\n          border-radius: 4px;\n        }\n\n        .tree-container::-webkit-scrollbar-thumb {\n          background: var(--tree-scrollbar-thumb, #888);\n          border-radius: 4px;\n        }\n\n        .tree-container::-webkit-scrollbar-thumb:hover {\n          background: var(--tree-scrollbar-thumb-hover, #555);\n        }\n      </style>\n\n      <div class=\"${ containerClass }\">\n        ${ this.data.length > 0\n        ? this.data.map( node => this.renderNode( node ) ).join( '' )\n        : '<div class=\"tree-empty\">No items to display</div>'\n      }\n      </div>\n    `;\n  }\n}\n\n/**\n * Conditionally defines the custom element if in a browser environment.\n */\nconst defineTreeView = ( tagName: string = 'liwe3-tree-view' ): void => {\n  if ( typeof window !== 'undefined' && !window.customElements.get( tagName ) ) {\n    customElements.define( tagName, TreeViewElement );\n  }\n};\n\n// Auto-register with default tag name\ndefineTreeView();\n\nexport { defineTreeView };\n"],"names":["TreeViewElement","name","oldValue","newValue","dataAttr","e","value","ids","nodes","traverse","node","nodeId","nodeElement","childrenContainer","el","expandIcon","depth","childrenHtml","child","isSelected","checkbox","found","isExpanded","hasChildren","paddingLeft","iconHtml","target","checked","applyToDescendants","n","rootEl","cb","nodeContent","containerClass","defineTreeView","tagName"],"mappings":"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"}