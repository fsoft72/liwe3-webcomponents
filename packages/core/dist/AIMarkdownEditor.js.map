{"version":3,"file":"AIMarkdownEditor.js","sources":["../src/AIMarkdownEditor.ts"],"sourcesContent":["import { AITextEditorElement, defineAITextEditor } from './AITextEditor';\nimport { ButtonToolbarElement, ButtonToolbarGroup, defineButtonToolbar } from './ButtonToolbar';\nimport { MarkdownPreviewElement, defineMarkdownPreview } from './MarkdownPreview';\n\nexport class AIMarkdownEditorElement extends HTMLElement {\n  declare shadowRoot: ShadowRoot;\n  private aiEditor!: AITextEditorElement;\n  private toolbar!: ButtonToolbarElement;\n  private preview!: MarkdownPreviewElement;\n  private editorStatus!: HTMLElement;\n  private loading!: HTMLElement;\n  private isPreviewMode: boolean = false;\n  private markdownLibUrl: string = 'https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js';\n\n  constructor() {\n    super();\n    this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback(): void {\n    this.render();\n    this.init();\n  }\n\n  private render(): void {\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: flex;\n          flex-direction: column;\n          width: 100%;\n          height: 100%;\n          gap: 0.5rem;\n        }\n        \n        .editor-container {\n          flex: 1;\n          position: relative;\n          min-height: 0; /* Important for flexbox scrolling */\n          border: 2px solid #e1e5e9;\n          border-radius: 12px;\n          background: #fafbfc;\n        }\n        \n        .editor-container:focus-within {\n          border-color: #4facfe;\n          background: white;\n        }\n\n        .editor-status {\n          position: absolute;\n          top: 5px;\n          left: 5px;\n          width: 10px;\n          height: 10px;\n          border-radius: 100%;\n          background: #777;\n          z-index: 10;\n        }\n        \n        .loading {\n          position: absolute;\n          top: 5px;\n          right: 10px;\n          z-index: 10;\n          display: none;\n        }\n\n        .loading.show {\n          display: block;\n        }\n\n        .spinner {\n          width: 10px;\n          height: 10px;\n          border: 2px solid #e1e5e9;\n          border-top: 2px solid #4facfe;\n          border-radius: 50%;\n          animation: spin 1s linear infinite;\n        }\n\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n\n        liwe3-ai-text-editor {\n          width: 100%;\n          height: 100%;\n        }\n\n        .settings-modal {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          background: white;\n          padding: 20px;\n          border-radius: 8px;\n          box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n          z-index: 100;\n          width: 400px;\n          max-width: 90%;\n          display: none;\n          border: 1px solid #e5e7eb;\n        }\n\n        .settings-modal.open {\n          display: block;\n        }\n\n        .settings-modal h3 {\n          margin-top: 0;\n          margin-bottom: 15px;\n          font-size: 18px;\n          color: #1f2937;\n        }\n\n        .form-group {\n          margin-bottom: 15px;\n        }\n\n        .form-group label {\n          display: block;\n          margin-bottom: 5px;\n          font-size: 14px;\n          color: #4b5563;\n        }\n\n        .form-group input, .form-group textarea {\n          width: 100%;\n          padding: 8px;\n          border: 1px solid #d1d5db;\n          border-radius: 4px;\n          font-size: 14px;\n          box-sizing: border-box;\n        }\n\n        .form-group textarea {\n          resize: vertical;\n          min-height: 60px;\n        }\n\n        .modal-actions {\n          display: flex;\n          justify-content: flex-end;\n          gap: 10px;\n          margin-top: 20px;\n        }\n\n        .btn {\n          padding: 8px 16px;\n          border-radius: 4px;\n          border: none;\n          cursor: pointer;\n          font-size: 14px;\n        }\n\n        .btn-primary {\n          background: #3b82f6;\n          color: white;\n        }\n\n        .btn-secondary {\n          background: #e5e7eb;\n          color: #374151;\n        }\n\n        .overlay {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0,0,0,0.5);\n          z-index: 99;\n          display: none;\n        }\n\n        .overlay.open {\n          display: block;\n        }\n      </style>\n      <liwe3-button-toolbar id=\"toolbar\"></liwe3-button-toolbar>\n      <div class=\"editor-container\">\n        <div class=\"editor-status\"></div>\n        <div class=\"loading\" id=\"loading\">\n          <div class=\"spinner\"></div>\n        </div>\n        <liwe3-ai-text-editor id=\"editor\"></liwe3-ai-text-editor>\n        <liwe3-markdown-preview id=\"preview\" style=\"display: none; width: 100%; height: 100%; overflow: auto;\"></liwe3-markdown-preview>\n      </div>\n      \n      <div class=\"overlay\" id=\"overlay\"></div>\n      <div class=\"settings-modal\" id=\"settingsModal\">\n        <h3>AI Settings</h3>\n        <div class=\"form-group\">\n          <label for=\"apiKey\">API Key</label>\n          <input type=\"password\" id=\"apiKey\" placeholder=\"sk-...\">\n        </div>\n        <div class=\"form-group\">\n          <label for=\"systemPrompt\">System Prompt</label>\n          <textarea id=\"systemPrompt\"></textarea>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"modelName\">Model Name</label>\n          <input type=\"text\" id=\"modelName\" placeholder=\"gpt-3.5-turbo\">\n        </div>\n        <div class=\"form-group\">\n          <label for=\"apiEndpoint\">API Endpoint</label>\n          <input type=\"text\" id=\"apiEndpoint\" placeholder=\"https://api.openai.com/v1/chat/completions\">\n        </div>\n        <div class=\"form-group\">\n          <label for=\"markdownLibUrl\">Markdown Library URL</label>\n          <input type=\"text\" id=\"markdownLibUrl\" placeholder=\"https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js\">\n        </div>\n        <div class=\"form-group\">\n          <label for=\"suggestionDelay\">Suggestion Delay (seconds)</label>\n          <input type=\"number\" id=\"suggestionDelay\" step=\"0.1\" min=\"0.5\">\n        </div>\n        <div class=\"modal-actions\">\n          <button class=\"btn btn-secondary\" id=\"cancelBtn\">Cancel</button>\n          <button class=\"btn btn-primary\" id=\"saveBtn\">Save</button>\n        </div>\n      </div>\n    `;\n  }\n\n  private init(): void {\n    this.aiEditor = this.shadowRoot.getElementById('editor') as AITextEditorElement;\n    this.preview = this.shadowRoot.getElementById('preview') as MarkdownPreviewElement;\n    this.toolbar = this.shadowRoot.getElementById('toolbar') as ButtonToolbarElement;\n    this.editorStatus = this.shadowRoot.querySelector('.editor-status') as HTMLElement;\n    this.loading = this.shadowRoot.getElementById('loading') as HTMLElement;\n    \n    // Configure the AITextEditor in embedded mode with callbacks\n    this.aiEditor.configure({\n      embedded: true,\n      onStatusChange: (hasApiKey: boolean) => {\n        this.editorStatus.style.backgroundColor = hasApiKey ? '#4caf50' : '#777';\n      },\n      onLoadingChange: (isLoading: boolean) => {\n        if (isLoading) {\n          this.loading.classList.add('show');\n        } else {\n          this.loading.classList.remove('show');\n        }\n      }\n    });\n    \n    this.setupModal();\n    this.setupToolbar();\n    \n    // Forward events from aiEditor\n    this.aiEditor.addEventListener('change', (e: Event) => {\n      this.dispatchEvent(new CustomEvent('change', { \n        detail: (e as CustomEvent).detail,\n        bubbles: true,\n        composed: true \n      }));\n    });\n\n    this.aiEditor.addEventListener('beforeSuggestion', (e: Event) => {\n      this.dispatchEvent(new CustomEvent('beforeSuggestion', { \n        detail: (e as CustomEvent).detail,\n        bubbles: true,\n        composed: true,\n        cancelable: true\n      }));\n    });\n  }\n\n  private setupModal(): void {\n    const modal = this.shadowRoot.getElementById('settingsModal') as HTMLElement;\n    const overlay = this.shadowRoot.getElementById('overlay') as HTMLElement;\n    const cancelBtn = this.shadowRoot.getElementById('cancelBtn') as HTMLButtonElement;\n    const saveBtn = this.shadowRoot.getElementById('saveBtn') as HTMLButtonElement;\n\n    const close = () => {\n      modal.classList.remove('open');\n      overlay.classList.remove('open');\n    };\n\n    cancelBtn.addEventListener('click', close);\n    overlay.addEventListener('click', close);\n\n    saveBtn.addEventListener('click', () => {\n      const apiKey = (this.shadowRoot.getElementById('apiKey') as HTMLInputElement).value;\n      const systemPrompt = (this.shadowRoot.getElementById('systemPrompt') as HTMLTextAreaElement).value;\n      const modelName = (this.shadowRoot.getElementById('modelName') as HTMLInputElement).value;\n      const apiEndpoint = (this.shadowRoot.getElementById('apiEndpoint') as HTMLInputElement).value;\n      const markdownLibUrl = (this.shadowRoot.getElementById('markdownLibUrl') as HTMLInputElement).value;\n      const suggestionDelay = parseFloat((this.shadowRoot.getElementById('suggestionDelay') as HTMLInputElement).value);\n\n      this.aiEditor.setApiKey(apiKey);\n      this.aiEditor.setSystemPrompt(systemPrompt);\n      this.aiEditor.setModelName(modelName);\n      this.aiEditor.setApiEndpoint(apiEndpoint);\n      this.markdownLibUrl = markdownLibUrl;\n      if (!isNaN(suggestionDelay)) {\n        this.aiEditor.setSuggestionDelay(suggestionDelay);\n      }\n\n      close();\n    });\n  }\n\n  private openSettings(): void {\n    const modal = this.shadowRoot.getElementById('settingsModal') as HTMLElement;\n    const overlay = this.shadowRoot.getElementById('overlay') as HTMLElement;\n    \n    // Load current values\n    (this.shadowRoot.getElementById('apiKey') as HTMLInputElement).value = this.aiEditor.getApiKey();\n    (this.shadowRoot.getElementById('systemPrompt') as HTMLTextAreaElement).value = this.aiEditor.getSystemPrompt();\n    (this.shadowRoot.getElementById('modelName') as HTMLInputElement).value = this.aiEditor.getModelName();\n    (this.shadowRoot.getElementById('apiEndpoint') as HTMLInputElement).value = this.aiEditor.getApiEndpoint();\n    (this.shadowRoot.getElementById('markdownLibUrl') as HTMLInputElement).value = this.markdownLibUrl;\n    (this.shadowRoot.getElementById('suggestionDelay') as HTMLInputElement).value = this.aiEditor.getSuggestionDelay().toString();\n\n    modal.classList.add('open');\n    overlay.classList.add('open');\n  }\n\n  private setupToolbar(): void {\n    const groups: ButtonToolbarGroup[] = [\n      {\n        id: 'format',\n        items: [\n          {\n            id: 'bold',\n            label: 'B',\n            tooltip: 'Bold',\n            icon: '<svg viewBox=\"0 0 24 24\"><path d=\"M8 11h4.5a2.5 2.5 0 0 0 0-5H8v5zm10 4.5a4.5 4.5 0 0 1-4.5 4.5H6V4h6.5a4.5 4.5 0 0 1 3.26 7.586A4.5 4.5 0 0 1 18 15.5zM8 13v5h5.5a2.5 2.5 0 0 0 0-5H8z\"/></svg>'\n          },\n          {\n            id: 'italic',\n            label: 'I',\n            tooltip: 'Italic',\n            icon: '<svg viewBox=\"0 0 24 24\"><path d=\"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z\"/></svg>'\n          },\n          {\n            id: 'underline',\n            label: 'U',\n            tooltip: 'Underline',\n            icon: '<svg viewBox=\"0 0 24 24\"><path d=\"M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z\"/></svg>'\n          }\n        ]\n      },\n      {\n        id: 'lists',\n        items: [\n          {\n            id: 'ul',\n            label: 'UL',\n            tooltip: 'Unordered List',\n            icon: '<svg viewBox=\"0 0 24 24\"><path d=\"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z\"/></svg>'\n          },\n          {\n            id: 'ol',\n            label: 'OL',\n            tooltip: 'Numbered List',\n            icon: '<svg viewBox=\"0 0 24 24\"><path d=\"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z\"/></svg>'\n          }\n        ]\n      },\n      {\n        id: 'settings',\n        items: [\n          {\n            id: 'preview',\n            tooltip: 'Toggle Preview',\n            icon: '<svg viewBox=\"0 0 24 24\"><path d=\"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\"/></svg>'\n          },\n          {\n            id: 'settings',\n            tooltip: 'AI Settings',\n            icon: '<svg viewBox=\"0 0 24 24\"><path d=\"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L4.16 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.04.24.24.41.48.41h3.84c.24 0 .43-.17.47-.41l.36-2.54c.59-.24 1.13-.57 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.08-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z\"/></svg>'\n          }\n        ]\n      }\n    ];\n\n    this.toolbar.groups = groups;\n    this.toolbar.addEventListener('button-click', (e: Event) => {\n      const detail = (e as CustomEvent).detail;\n      this.handleToolbarAction(detail.id);\n    });\n  }\n\n  private togglePreview(): void {\n    this.isPreviewMode = !this.isPreviewMode;\n    if (this.isPreviewMode) {\n      this.preview.value = this.aiEditor.getText();\n      this.preview.libUrl = this.markdownLibUrl;\n      this.aiEditor.style.display = 'none';\n      this.preview.style.display = 'block';\n    } else {\n      this.aiEditor.style.display = 'block';\n      this.preview.style.display = 'none';\n    }\n  }\n\n  private handleToolbarAction(actionId: string): void {\n    if (actionId === 'preview') {\n      this.togglePreview();\n      return;\n    }\n\n    const textarea = this.aiEditor.shadowRoot?.getElementById('editor') as HTMLTextAreaElement;\n    if (!textarea) return;\n\n    const start = textarea.selectionStart;\n    const end = textarea.selectionEnd;\n    const text = textarea.value;\n    const selectedText = text.substring(start, end);\n    \n    let newText = '';\n    let newCursorPos = end;\n\n    switch (actionId) {\n      case 'settings':\n        this.openSettings();\n        return; // Exit early as we don't need text manipulation\n      case 'bold':\n        newText = text.substring(0, start) + `**${selectedText}**` + text.substring(end);\n        newCursorPos = end + 4; // ** + **\n        if (start === end) newCursorPos = start + 2; // Position inside **\n        break;\n      case 'italic':\n        newText = text.substring(0, start) + `*${selectedText}*` + text.substring(end);\n        newCursorPos = end + 2; // * + *\n        if (start === end) newCursorPos = start + 1; // Position inside *\n        break;\n      case 'underline':\n        newText = text.substring(0, start) + `<u>${selectedText}</u>` + text.substring(end);\n        newCursorPos = end + 7; // <u> + </u>\n        if (start === end) newCursorPos = start + 3; // Position inside <u>\n        break;\n      case 'ul':\n        // For lists, we want to handle multiline selection\n        if (start !== end) {\n          const lines = selectedText.split('\\n');\n          const listText = lines.map(line => `- ${line}`).join('\\n');\n          newText = text.substring(0, start) + listText + text.substring(end);\n          newCursorPos = start + listText.length;\n        } else {\n          // Insert at beginning of line? Or just insert marker?\n          // Simple version: insert marker\n          newText = text.substring(0, start) + `- ` + text.substring(end);\n          newCursorPos = start + 2;\n        }\n        break;\n      case 'ol':\n        if (start !== end) {\n          const lines = selectedText.split('\\n');\n          const listText = lines.map((line, i) => `${i + 1}. ${line}`).join('\\n');\n          newText = text.substring(0, start) + listText + text.substring(end);\n          newCursorPos = start + listText.length;\n        } else {\n          newText = text.substring(0, start) + `1. ` + text.substring(end);\n          newCursorPos = start + 3;\n        }\n        break;\n    }\n\n    if (newText) {\n      textarea.value = newText;\n      textarea.focus();\n      \n      // If we just inserted markers around empty selection, put cursor inside\n      if (start === end) {\n        if (actionId === 'bold') textarea.setSelectionRange(start + 2, start + 2);\n        else if (actionId === 'italic') textarea.setSelectionRange(start + 1, start + 1);\n        else if (actionId === 'underline') textarea.setSelectionRange(start + 3, start + 3);\n        else textarea.setSelectionRange(newCursorPos, newCursorPos);\n      } else {\n        // Select the modified text\n        // This is a bit complex to calculate exactly for all cases, so just putting cursor at end for now\n        textarea.setSelectionRange(newCursorPos, newCursorPos);\n      }\n\n      // Trigger input event so AITextEditor updates\n      textarea.dispatchEvent(new Event('input', { bubbles: true }));\n    }\n  }\n\n  // Proxy methods to AITextEditor\n  setText(text: string): void {\n    if (this.aiEditor) {\n      this.aiEditor.setText(text);\n    }\n  }\n\n  getText(): string {\n    return this.aiEditor ? this.aiEditor.getText() : '';\n  }\n\n  setApiKey(key: string): void {\n    if (this.aiEditor) {\n      this.aiEditor.setApiKey(key);\n    }\n  }\n\n  getApiKey(): string {\n    return this.aiEditor ? this.aiEditor.getApiKey() : '';\n  }\n\n  setSuggestionDelay(seconds: number): void {\n    if (this.aiEditor) {\n      this.aiEditor.setSuggestionDelay(seconds);\n    }\n  }\n\n  getSuggestionDelay(): number {\n    return this.aiEditor ? this.aiEditor.getSuggestionDelay() : 1;\n  }\n\n  setSystemPrompt(prompt: string): void {\n    if (this.aiEditor) {\n      this.aiEditor.setSystemPrompt(prompt);\n    }\n  }\n\n  getSystemPrompt(): string {\n    return this.aiEditor ? this.aiEditor.getSystemPrompt() : '';\n  }\n\n  setApiEndpoint(endpoint: string): void {\n    if (this.aiEditor) {\n      this.aiEditor.setApiEndpoint(endpoint);\n    }\n  }\n\n  getApiEndpoint(): string {\n    return this.aiEditor ? this.aiEditor.getApiEndpoint() : '';\n  }\n\n  setModelName(modelName: string): void {\n    if (this.aiEditor) {\n      this.aiEditor.setModelName(modelName);\n    }\n  }\n\n  getModelName(): string {\n    return this.aiEditor ? this.aiEditor.getModelName() : '';\n  }\n\n  setContext(context: string): void {\n    if (this.aiEditor) {\n      this.aiEditor.setContext(context);\n    }\n  }\n\n  getContext(): string {\n    return this.aiEditor ? this.aiEditor.getContext() : '';\n  }\n}\n\nexport const defineAIMarkdownEditor = (tagName: string = 'liwe3-ai-markdown-editor'): void => {\n  if (typeof window !== 'undefined') {\n    defineAITextEditor();\n    defineButtonToolbar();\n    defineMarkdownPreview();\n    if (!customElements.get(tagName)) {\n      customElements.define(tagName, AIMarkdownEditorElement);\n    }\n  }\n};\n"],"names":["AIMarkdownEditorElement","hasApiKey","isLoading","e","modal","overlay","cancelBtn","saveBtn","close","apiKey","systemPrompt","modelName","apiEndpoint","markdownLibUrl","suggestionDelay","groups","detail","actionId","textarea","start","end","text","selectedText","newText","newCursorPos","listText","line","i","key","seconds","prompt","endpoint","context","defineAIMarkdownEditor","tagName","defineAITextEditor","defineButtonToolbar","defineMarkdownPreview"],"mappings":"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"}